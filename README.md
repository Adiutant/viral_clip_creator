## README
Гипотеза:
 В начале работы над кейсом была выдвинута гипотеза, что виральность клипа можно определить по некоторым критериям. Нами были выбраны следующие критерии:
Динамичность видеопотока
Количество уникальных слов в фрагменте видео
Тональность фрагмента со шкалой оценки эмоции
 В ходе разработки, опытным путем гипотеза была доказана и на основе нее было создано решение кейса.

Алгоритм решения:
Видео загружается в ML-сервис и происходит его транскрибация с помощью Whisper
Видео делится на 30 секундные сегменты и каждый из них проходит оценку по критериям:
Проводится оценка динамичности сцены средствами OpenCV
Подсчитывается количество уникальных слов
С помощью предобученного ruBERT определяется тональность фрагмента и ему выдается оценка исходя из определенной эмоции
По полученным данным формируются три графика для полного видео и комбинируются с нормализацией и сглаживанием
С помощью методов обработки сигнала (нахождение пиков) определяются ключевые моменты и их длина, получается список виральных клипов отсортированный по комбинированной метрике
![combined_plot_with_peaks](https://github.com/user-attachments/assets/bbe2a4f6-9d97-4357-8adc-4ffea86fc63c)

Исходя из выдвинутой гипотезы - пики в результирующем графике будут являться центрами виральных клипов, а ПШПВ (полная ширина пика на полувысоте) пика можно использовать как оптимальную длину.

Этот веб-сервис предоставляет API для загрузки видео, обработки задач и получения результатов. Он может быть развернут с использованием Docker. Ниже приведена документация по его использованию.

▎Запуск с помощью Docker

   
   docker build -t my-video-service .
   

2. Запустите контейнер:
   
   docker run -p 5000:5000 my-video-service
   

▎API Эндпоинты

▎1. /set_video_download

- Метод: POST
- Описание: Загружает видео по указанной ссылке и добавляет задачу на обработку.
- Параметры запроса (JSON):
  - download_url (string): URL для загрузки видео.
  - filename (string): Имя файла для сохранения.
  - md5 (string, optional): MD5 хэш для проверки целостности файла.
- Ответ:
  - Успешно: {"task_id": "<task_id>"}
  - Ошибка: {"error": "<описание ошибки>"}

▎2. /task_status

- Метод: POST
- Описание: Проверяет статус задачи обработки видео.
- Параметры запроса (JSON):
  - task_id (string): Идентификатор задачи.
- Ответ:
  - Успешно: JSON объект с результатами задачи.
  - Ошибка: {"result": "error", "error_str": "<описание ошибки>"}

▎3. /download/<filename>

- Метод: GET
- Описание: Позволяет скачать обработанный файл по его имени.
- Параметры URL:
  - <filename> (string): Имя файла для скачивания.
- Ответ: Файл для скачивания.

▎Пример использования

▎Загрузка видео

curl -X POST http://localhost:5000/set_video_download \
-H "Content-Type: application/json" \
-d '{"download_url": "http://example.com/video.mp4", "filename": "video.mp4", "md5": "abcd1234"}'


▎Проверка статуса задачи

curl -X POST http://localhost:5000/task_status \
-H "Content-Type: application/json" \
-d '{"task_id": "your_task_id_here"}'


▎Скачивание файла

curl -O http://localhost:5000/download/video.mp4
